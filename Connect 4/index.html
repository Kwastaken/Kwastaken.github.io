<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <title>Document</title>
  </head>
  <body>
    <script>
      let row = 6;
      let col = 7;
      let move = 0;
      let yellow = [];
      let red = [];
      let colFilled = [5, 5, 5, 5, 5, 5, 5];
      for (let i = 1; i <= row * col; i++) {
        let divCreator = document.createElement("div");
        let position = [((i - 1) % row) * 72, Math.floor((i - 1) / row) * 72];
        window.scrollTo(position[1], position[0]);
        divCreator.style.width = "70px";
        divCreator.style.height = "70px";
        divCreator.style.position = "absolute";
        divCreator.style.top = position[0] + "px";
        divCreator.style.left = position[1] + "px";
        divCreator.style.background = "rgb(30,30,180)";
        divCreator.style.borderRadius = "50%";
        divCreator.style.display = "flex";
        divCreator.style.alignItems = "center";
        divCreator.style.justifyContent = "center";
        divCreator.id = `${(i - 1) % row}${Math.floor((i - 1) / row)}`;
        /*divCreator.innerHTML = `${
          (((i - 1) % row) * 10 + Math.floor((i - 1) / row)) % 11
        }`;*/
        document.body.appendChild(divCreator);
      }
      let div = document.querySelectorAll("div");

      div.forEach((e) => {
        e.addEventListener("click", () => {
          let id = e.id;
          game(id);
        });
      });
      function game(id) {
        console.log(id);
        if (colFilled[id.charAt(1)] == -1) {
          return;
        }
        id = colFilled[id.charAt(1)] + id.charAt(1);
        //console.log(id);
        colFilled.splice(id.charAt(1), 1, colFilled[id.charAt(1)] - 1);
        console.log(colFilled);
        if (move % 2 == 1) {
          document.getElementById(id).style.background = "yellow";
          yellow.push(id);
          if (winChecker(yellow, id) == "w") {
            setTimeout(() => {
              alert("Yellow winner");
            }, 50);
          }
        } else {
          document.getElementById(id).style.background = "red";
          red.push(id);
          if (winChecker(red, id) == "w") {
            setTimeout(() => {
              alert("Red winner");
            }, 50);
          }
        }
        //console.log(red);
        //console.log(yellow);
        move++;
        while (move % 2 == 1) {
          game(bot());
        }
        if (move == 42) {
          setTimeout(() => {
            alert("Draw game");
          }, 50);
        }
      }
      function winChecker(moves, id) {
        let inARow = 0;
        let i;
        let x;
        if (move < 6) {
          console.log("return");
          return;
        }
        //THIS IS ROW
        inARow = 0;
        i = id.charAt(0);
        for (x = 0; x <= 6; x++) {
          if (moves.includes(`${i}${x}`)) {
            inARow++;
          } else {
            inARow = 0;
          }
          if (inARow == 4) {
            return "w";
          }
        }
        //THIS IS COLUMN
        if (id.charAt(0) <= 2) {
          inARow = 0;
          x = id.charAt(1);
          for (i = id.charAt(0); i <= id.charAt(0) + 3; i++) {
            if (moves.includes(`${i}${x}`)) {
              inARow++;
            } else {
              inARow = 0;
            }
            if (inARow == 4) {
              return "w";
            }
          }
        }
        //THIS IS NE DIAGONAL UPPER
        if (id % 9 == 3 || id % 9 == 4 || id % 9 == 5) {
          x = id % 11;
          inARow = 0;
          for (let i = x; i >= 0; i--) {
            if (moves.includes(`${i}${x - i}`)) {
              inARow++;
            } else {
              inARow = 0;
            }
            if (inARow == 4) {
              return "w";
            }
          }
        }
        //THIS IS NE DIAGONAL LOWER
        if (id % 9 == 6 || id % 9 == 7 || id % 9 == 8) {
          x = (id % 9) - 5;
          inARow = 0;
          for (let i = x; i <= 6; i++) {
            if (moves.includes(`${5 + x - i}${i}`)) {
              inARow++;
            } else {
              inARow = 0;
            }
            if (inARow == 4) {
              return "w";
            }
          }
        }
        //THIS IS SE DIAGONAL LOWER
        if (id % 11 == 0 || id % 11 == 10 || id % 11 == 9) {
          x = (11 - (id % 11)) % 11;
          inARow = 0;
          for (i = x; i <= 5; i++) {
            if (moves.includes(`${i}${i - x}`)) {
              inARow++;
            } else {
              inARow = 0;
            }
            if (inARow == 4) {
              return "w";
            }
          }
        }
        //THIS IS SE DIAGONAL UPPER
        if (id % 11 == 1 || id % 11 == 2 || id % 11 == 3) {
          x = id % 11;
          inARow = 0;
          for (let i = x; i <= 6; i++) {
            if (moves.includes(`${i - x}${i}`)) {
              inARow++;
            } else {
              inARow = 0;
            }
            if (inARow == 4) {
              return "w";
            }
          }
        }
      }
      function bot() {
        return `${50 + Math.floor(Math.random() * 7)}`;
      }
    </script>
  </body>
</html>
